/* All the targets */

targets = [
  {
    "Manufacturer": "Rinehart",
    "Type": "Bear",
    "Name": "Cinnamon Bear",
    "Image": "Bear-CinnamonBear.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Bear",
    "Name": "Large Black Bear",
    "Image": "Bear-LargeBlackBear.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Bear",
    "Name": "Mountain Grizzly",
    "Image": "Bear-MountainGrizzlyBear.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Bear",
    "Name": "Polar Bear",
    "Image": "Bear-PolarBear.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Big Game",
    "Name": "Moose",
    "Image": "BigGame-Moose.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Big Game",
    "Name": "Pronghorn Antelope",
    "Image": "BigGame-PronghornAntelope.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Boar",
    "Name": "Javelina",
    "Image": "Boar-Javelina.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Boar",
    "Name": "Razor Back",
    "Image": "Boar-RazorBack.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Boar",
    "Name": "Rising Boar",
    "Image": "Boar-RisingBoar.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "30 Point Buck",
    "Image": "Deer-30PointBuck.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Alert Deer",
    "Image": "Deer-AlertDeer.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Apple Browsing Buck",
    "Image": "Deer-AppleBrowsingBuck.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Bedded Doe",
    "Image": "Deer-BeddedDoe.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Big Ten Buck",
    "Image": "Deer-BigTenBuck.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Fallow Deer",
    "Image": "Deer-FallowDeer.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Feeding Deer",
    "Image": "Deer-FeedingDoe.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Fighting Rubbing Deer",
    "Image": "Deer-FightingRubbingBuck.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Giant Mule Deer",
    "Image": "Deer-GiantMuleDeer.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Deer",
    "Name": "Spike Buck",
    "Image": "Deer-SpikeBuck.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Exotic",
    "Name": "Baboon",
    "Image": "Exotic-Baboon.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Exotic",
    "Name": "Green Cobra",
    "Image": "Exotic-GreenCobra.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Exotic",
    "Name": "Green Frog",
    "Image": "Exotic-GreenFrog.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Exotic",
    "Name": "Hadrosaur",
    "Image": "Exotic-Hadrosaur.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Exotic",
    "Name": "Stegosaurus",
    "Image": "Exotic-Stegosaurus.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Exotic",
    "Name": "Velociraptor",
    "Image": "Exotic-Velociraptor.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Fish",
    "Name": "Carp",
    "Image": "Fish-Carp.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Predator",
    "Name": "Black Panther",
    "Image": "Predator-BlackPanther.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Predator",
    "Name": "Coyote",
    "Image": "Predator-Coyote.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Predator",
    "Name": "Snarling Wolf",
    "Image": "Predator-SnarlingWolf.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Predator",
    "Name": "Wolverine",
    "Image": "Predator-Wolverine.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Sheep",
    "Name": "Catalina Goat",
    "Image": "Sheep-CatalinaGoat.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Sheep",
    "Name": "Stone Sheep",
    "Image": "Sheep-StoneSheep.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Turkey",
    "Name": "Gobbler",
    "Image": "Turkey-Gobbler.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Turkey",
    "Name": "Strutting Turkey",
    "Image": "Turkey-StruttingTurkey.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Turkey",
    "Name": "Tom Turkey",
    "Image": "Turkey-TomTurkey.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Varmint",
    "Name": "Bobcat",
    "Image": "Varmint-Bobcat.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Varmint",
    "Name": "Raccoon",
    "Image": "Varmint-Raccoon.png"
  },
  {
    "Manufacturer": "Rinehart",
    "Type": "Varmint",
    "Name": "Skunk",
    "Image": "Varmint-Skunk.png"
  }
];

/* Groups of Targets */
manufacturer = [];
type = [];
manufacturers = [];
types = [];

targets.forEach(function(t) {
	target = {
		url: 'targets/' + t.Manufacturer + '/' + t.Image,
		caption: t.Name,
		type: t.Type,
		manufacturer: t.Manufacturer
	};
	if (typeof manufacturer[t.Manufacturer] === 'undefined') {
		manufacturer[t.Manufacturer] = [];
	}
	manufacturer[t.Manufacturer].push(target);
	
	if (typeof type[t.Type] === 'undefined') {
		type[t.Type] = [];
	}
	type[t.Type].push(target);
	
	// add to manufacturer list
	existing_manu = manufacturers.find(function(e) {
		if (e.name == t.Manufacturer) {
			return true;
		} else {
			return false;
		}
	}); 
	if (! existing_manu) {
		manufacturers.push({"name": t.Manufacturer});
	}
	
	// add to types list
	existing_type = types.find(function(e) {
		if (e.name == t.Type) {
			return true;
		} else {
			return false;
		}
	}); 
	if (! existing_type) {
		types.push({"name": t.Type});
	}
});


var $$ = Dom7;

/*=== TEMPLATES ===*/
var manTemplate = $$('#man-template').html();
var compiledManTemplate = Template7.compile(manTemplate);

var html = compiledManTemplate({ manufacturers: manufacturers });
$$('#man-links').html(html);

var typeTemplate = $$('#type-template').html();
var compiledTypeTemplate = Template7.compile(typeTemplate);

var html = compiledTypeTemplate({ types: types });
$$('#type-links').html(html);


var app = new Framework7({
  // App root element
  root: '#app',
  // App Name
  name: 'My App',
  // App id
  id: 'com.myapp.test',
  // Enable swipe panel
  panel: {
    swipe: 'left',
  },
  // Add default routes
  routes: [
    {
      path: '/about/',
      url: 'about.html',
    },
  ],
  
  // ... other parameters
});

var mainView = app.views.create('.view-main');

/*=== Galleries ===*/
var pb = [];
targets.forEach(function(t) {
	//console.log('Creating: ' + t);
	pb[t.Manufacturer] = app.photoBrowser.create({
		photos: manufacturer[t.Manufacturer],
		type: 'popup'
	});
	pb[t.Type] = app.photoBrowser.create({
		photos: type[t.Type],
		type: 'popup'
	});
});


$$('.pb-popup-manufacturer').on('click', function (e) {
	//console.log(e.target.id);
	pb[e.target.id].open();
});

$$('.pb-popup-type').on('click', function (e) {
	//console.log(e.target.id);
	pb[e.target.id].open();
});


    
